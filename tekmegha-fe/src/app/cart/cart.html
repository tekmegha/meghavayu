@if (isLoading) {
  <app-skeleton-loader></app-skeleton-loader>
} @else {
  <div class="cart-container">
    <h1>Your Cart</h1>

    <div class="cart-items">
      @if ((cartState$ | async)?.items.length === 0) {
        <div class="empty-cart">
          <h3>Your cart is empty</h3>
          <p>Add some delicious coffee items to get started!</p>
        </div>
      } @else {
        @for (item of (cartState$ | async)?.items; track item.id) {
          <div class="cart-item">
            <img [src]="item.imageUrl" [alt]="item.name" class="item-image" (error)="onImageError($event)">
            <div class="item-details">
              <h3>{{ item.name }}</h3>
              <p>Quantity: {{ item.quantity }}</p>
              <span class="price">₹{{ (item.price * item.quantity) | number:'1.2-2' }}</span>
            </div>
            <button class="remove-item">Remove</button>
          </div>
        }
      }
    </div>

    @if ((cartState$ | async)?.items.length > 0) {
      <div class="cart-summary">
        <h3>Order Summary</h3>
        <p>Subtotal: ₹{{ (cartState$ | async)?.totalAmount | number:'1.2-2' }}</p>
        <p>Delivery Fee: ₹{{ deliveryFee | number:'1.2-2' }}</p>
        <h4>Total: ₹{{ getTotalWithDelivery((cartState$ | async)!) | number:'1.2-2' }}</h4>
        <button class="pay-button" (click)="payWithRazorpay()">Pay Now</button>
      </div>
    }
  </div>
}
